

<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>八仙塵爆傷者開放資料查詢</title>
    
    
    
    <link rel='stylesheet prefetch' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css'>
<style>
      [ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
  display: none !important;
}
    </style>

<script>
  window.console = window.console || function(t) {};
  window.open = function(){ console.log("window.open is disabled."); };
  window.print   = function(){ console.log("window.print is disabled."); };
</script>

    <!-- fork 陳小風 -->
    
  </head>

  <body>
  <div class="container" ng-cloak ng-app="app" ng-controller="MainController as MainCtrl">
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">八仙塵爆傷者開放資料查詢</a>
      </div>

      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="http://www.gov.taipei/ct.asp?xItem=108880666&ctNode=38161&mp=100001" target="_blank">資料來源: 臺北市府資訊局</a>
          </li>
          <li>
            <a href="http://creativecommons.tw/cc0" target="_blank">License: CC0</a>
          </li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">其他平台 <span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="http://er.mohw.g0v.tw/#/dashboard/file/default.json" target="_blank">全國重度級急救責任醫院急診即時訊息</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
    <div class="container-fluid">
      <div class="form-group">
        <input type="text" class="form-control" ng-model="MainCtrl.query" placeholder="請輸入搜尋的條件（ex. 姓名、檢傷、收治單位）" />
      </div>
    </div>
  </nav>
    <div class="row">
      <div class="col-lg-12">
        <div>
          <span class="label label-info">最後更新: {{ MainCtrl.Data.lastmodify  }}</span>
<!--           <br />
          <span class="label label-success">已出院：{{success}}人</span>
          <span class="label label-warning">未出院：{{warning}}人</span>
 -->        </div>
        <br />
        <div class="alert alert-warning" role="alert">
          於臺北市醫院就醫之傷者家屬,若有相關問題,於晚上八點前可撥打社會局社工科電話
          <a href="tel:0227206528" target="_blank">02-27206528</a>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-12">
        <table st-table="MainCtrl.Data.data" class="table table-striped">
          <thead>
            <tr>
              <th>收治單位</th>
              <th>個人資料</th>
              <th>檢傷</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="row in MainCtrl.Data.data | filter:MainCtrl.query ">
              <td>
                {{ row['編號'] }}<br />
                <a href="https://www.google.com/maps?q={{ map[row['收治單位']].address || row['收治單位'] }}" target="_blank">{{ row['縣市別']}}<br />{{row['收治單位']}}</a><br />
                <span ng-if="map[row['收治單位']].phone" class="animate-if">
                  <a href="tel:{{map[row['收治單位']].phone}}" target="_blank" style="white-space: nowrap;">{{map[row['收治單位']].phone}}</a><br />
                </span>
                <span ng-if="hospital[row['收治單位']]" class="animate-if">
                  <button type="button" class="btn btn-info btn-xs" ng-click="getHospital(row['收治單位'])">社福中心</button>
                </span>
              </td>
              <td>
                {{ row['姓名']}}<br />
                <span class="label label-default">{{ row['性別']}} {{ row['年齡']}}</span><br />
                <span class="label label-default">{{ row['國籍']}}</span>
              </td>
              <td>
                <span class="label label-default">醫療檢傷: {{row['醫療檢傷']}}</span><br />
                <span class="label label-default">救護檢傷: {{row['救護檢傷']}}</span><br />
                <span class="label label-default">檢傷編號: {{row['檢傷編號']}}</span><br />
                <span class="label label-default">轉診要求: {{row['轉診要求']}}</span><br />
                <span class="label label-default">刪除註記: {{row['刪除註記']}}</span><br />
                <h4>
                  <span ng-switch="row['即時動向']">
                    <span ng-switch-when="出院" class="label label-success">
                      即時動向: {{row['即時動向']}}
                    </span>
                    <span ng-switch-when="自動出院
(AAD)" class="label label-success">
                      即時動向: {{row['即時動向']}}
                    </span>
                    <span ng-switch-default class="label label-primary">
                      即時動向: {{row['即時動向']}}
                    </span>
                  </span>
                </h4>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.14/angular.min.js"></script>
  <script src="https://cdn.rawgit.com/lorenzofox3/Smart-Table/master/dist/smart-table.js"></script>

<script>
angular
.module('app', ['smart-table'])
.controller('MainController',
  function ($log, $http, $scope) {
    var self = this;
    self.Data = [];
    $scope.warning = 0;
    $scope.success = 0;

    $http.get('http://tonyq.org/kptaipei/api-20150628.php').success(function (data) {
        self.Data = data;
        self.Data.data.forEach(function(item) {
          if (/出院/gi.test(item['即時動向'])) {
            $scope.success += 1;
          } else {
            $scope.warning += 1;
          }
        });
    });

    $scope.map = {
      '聯醫仁愛': {
        'phone': '02-27093600',
        'address': '臺北市大安區仁愛路四段10號'        
      },
      '聯醫中興': {
        'phone': '02-25523234',
        'address': '臺北市鄭州路145號'        
      },
      '聯醫忠孝': {
        'phone': '02-27861288',
        'address': '臺北市南港區同德路87號'        
      },
      '聯醫陽明': {
        'phone': '02-28353456',
        'address': '臺北市雨聲街105號'        
      },
      '臺大醫院': {
        'phone': '02-23123456',
        'address': '臺北市中正區中山南路7號'        
      },
      '松山三總': {
        'phone': '02-27642151',
        'address': '臺北市松山區健康路131號'        
      },
      '內湖三總': {
        'phone': '02-87923311',
        'address': '臺北市成功路二段325號'        
      },
      '臺北榮總': {
        'phone': '02-28712121',
        'address': '臺北市北投區石牌路二段201號'        
      },
      '臺北國泰': {
        'phone': '02-27082121',
        'address': '臺北市仁愛路四段280號'        
      },
      '臺北馬偕': {
        'phone': '02-25433535',
        'address': '臺北市中山區中山北路二段92號'        
      },
      '新光醫院': {
        'phone': '02-28332211',
        'address': '臺北市士林區文昌路95號'        
      },
      '振興醫院': {
        'phone': '02-28264400',
        'address': '臺北市北投區振興街45號'        
      },
      '淡水馬偕': {
        'phone': '02-25433535',
        'address': '新北市淡水區民生路45號'        
      },
      '聖保祿醫': {
        'phone': '03-3773300',
        'address': '桃園市桃園區建新街123號'        
      },
      '中國附醫': {
        'phone': '02-27919696',
        'address': '臺北市內湖區內湖路二段360號'        
      },
      '中國': {
        'phone': '02-27919696',
        'address': '臺北市內湖區內湖路二段360號'        
      },
      '北醫附醫': {
        'phone': '02-27372181',
        'address': '臺北市信義區吳興街252號'        
      },
      '萬芳醫院': {
        'phone': '02-29307930',
        'address': '臺北市文山區興隆路三段111號'        
      },
      '中山醫院': {
        'phone': '02-27081166',
        'address': '臺北市大安區仁愛路四段112巷11號'        
      },
      '義大醫院': {
        'phone': '07-6150011',
        'address': '雄市燕巢區義大路1號'        
      },
      '基隆長庚': {
        'phone': '02-24313131',
        'address': '基隆市安樂區麥金路222號'        
      },
      '新竹馬偕': {
        'phone': '03-6119595',
        'address': '新竹市東區光復路二段690號'        
      },
      '衛部台北': {
        'phone': '02-22765566',
        'address': '新北巿新莊區思源路127號'        
      },
      '板橋市醫': {
        'phone': '02-22575151',
        'address': '新北市板橋區英士路198號'        
      },
      '三重市醫': {
        'phone': '02-29829111',
        'address': '新北市三重區新北大道一段3號'        
      },
      '亞東醫院': {
        'phone': '02-89667000',
        'address': '新北市板橋區南雅南路二段21號'        
      },
      '慈濟台北': {
        'phone': '02-66289779',
        'address': '新北市新店區建國路289號'        
      },
      '恩主': {
        'phone': '02-26723456',
        'address': '新北市三峽區復興路399號'        
      },
      '國泰汐止': {
        'phone': '02-26482121',
        'address': '新北市汐止區建成路59巷2號'        
      },
      '耕莘醫院': {
        'phone': '02-22193391',
        'address': '新北市新店區中正路362號'        
      },
      '雙和醫院': {
        'phone': '02-22490088',
        'address': ' 新北市中和區中正路291號'        
      },
      '板橋中興': {
        'phone': '02-29590707',
        'address': '新北市板橋區忠孝路15號'        
      },
      '新泰': {
        'phone': '02-29962121',
        'address': '新北市新莊區新泰路157號'        
      },
      '桃園醫院': {
        'phone': '03-3699721',
        'address': '園市桃園區中山路1492號'        
      },
      '桃園總醫': {
        'phone': '03-4799595',
        'address': '桃園縣龍潭鄉中興路168號'        
      },
      '林口長庚': {
        'phone': '03-3281200',
        'address': '桃園市龜山區復興街5號'        
      },
      '敏盛': {
        'phone': '03-3179599',
        'address': '桃園市桃園區經國路168號'        
      },
      '壢新': {
        'phone': '03-4941234',
        'address': '桃園市平鎮區廣泰路77號'        
      },
      '台北長庚': {
        'phone': '02-27135211',
        'address': '臺北市敦化北路199號'        
      },
      '聖保祿醫院': {
        'phone': '03-3613141',
        'address': ' 桃園市桃園區建新街123號'        
      }
    };

    $scope.getHospital = function(name) {
      var hospital = $scope.hospital[name];
      alert(
        '社福中心: ' + hospital['社福中心'] + '\n' +
        '辦公室電話: ' + hospital['辦公室電話'] + '\n' +
        '主任: ' + hospital['主任'] + '\n' +
        '主任手機: ' + hospital['主任手機']
      );
    };

    $scope.hospital = {
      '臺大醫院': {
          "社福中心": "中正",
          "辦公室電話": "02-23962340",
          "主任": "林巧翊主任",
          "主任手機": "0972699132"
      },
      '聯醫中興': {
          "社福中心": "大同",
          "辦公室電話": "02-25974280",
          "主任": "李恩琪",
          "主任手機": "0972699126"
      },
      '臺北馬偕': {
          "社福中心": "中山",
          "辦公室電話": "02-25156223",
          "主任": "蔡淑婉主任",
          "主任手機": "0972699122"
      },
      '松山三總': {
          "社福中心": "松山",
          "辦公室電話": "02-27565018",
          "主任": "黃婉貞",
          "主任手機": "0972699159"
      },
      '聯醫仁愛': {
          "社福中心": "大安",
          "辦公室電話": "02-27000960",
          "主任": "張必宜",
          "主任手機": "0972699146"
      },
      '臺北國泰': {
          "社福中心": "大安",
          "辦公室電話": "02-27000960",
          "主任": "張必宜",
          "主任手機": "0972699146"
      },
      '北醫附醫': {
          "社福中心": "信義",
          "辦公室電話": "02-27616515",
          "主任": "蔡雅芬",
          "主任手機": "0972699155"
      },
      '新光醫院': {
          "社福中心": "士林",
          "辦公室電話": "02-28350247",
          "主任": "許嘉倪",
          "主任手機": "0972699177"
      },
      '聯醫陽明': {
          "社福中心": "士林",
          "辦公室電話": "02-28350247",
          "主任": "許嘉倪",
          "主任手機": "0972699177"
      },
      '臺北榮總': {
          "社福中心": "北投",
          "辦公室電話": "02-28942640",
          "主任": "謝麗華",
          "主任手機": "0972699183"
      },
      '振興醫院': {
          "社福中心": "北投",
          "辦公室電話": "02-28942640",
          "主任": "謝麗華",
          "主任手機": "0972699183"
      },
      '內湖三總': {
          "社福中心": "內湖",
          "辦公室電話": "02-27928701",
          "主任": "翁淑卿",
          "主任手機": "0972699166"
      },
      '聯醫忠孝': {
          "社福中心": "南港",
          "辦公室電話": "02-27831407",
          "主任": "蔡妙娟",
          "主任手機": "0972699173"
      },
      '萬芳醫院': {
          "社福中心": "文山",
          "辦公室電話": "02-29323587",
          "主任": "魏英珠",
          "主任手機": "0972187503"
      }
    };
});
      //@ sourceURL=pen.js
</script>

    
    <script>
  if (document.location.search.match(/type=embed/gi)) {
    window.parent.postMessage("resize", "*");
  }
</script>
  </body>
</html>
